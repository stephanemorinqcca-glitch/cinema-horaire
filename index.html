<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Horaires des films</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    .film { background: white; margin-bottom: 20px; padding: 15px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
    .title { font-size: 1.5em; font-weight: bold; text-transform: uppercase; color: #333; }
    .details { margin-top: 10px; }
    .time { font-weight: bold; color: #0077cc; }
  </style>
</head>
<body>
  <h1>ðŸŽ¬ SÃ©ances Ã  venir</h1>
  <div id="films"></div>

  <script>
    async function fetchSessions() {
      const response = await fetch('https://ticketing.useast.veezi.com/sessions/?siteToken=jjwk2hm92x8zmdt4ys4sr1vvp0');
      const text = await response.text();

      const parser = new DOMParser();
      const doc = parser.parseFromString(text, 'text/html');

      const container = document.getElementById('films');
      container.innerHTML = '';

      const blocks = doc.querySelectorAll('.session-listing');

      blocks.forEach(block => {
        const titleEl = block.querySelector('.film-title');
        const times = block.querySelectorAll('.session-time');
        const description = block.querySelector('.film-description');

        if (!titleEl || times.length === 0) return;

        const title = titleEl.textContent.trim().toUpperCase();
        const validTimes = Array.from(times).filter(t => !t.textContent.includes('RÃ‰SERVATIONS TERMINÃ‰ES'));

        if (validTimes.length === 0) return;

        const filmDiv = document.createElement('div');
        filmDiv.className = 'film';

        filmDiv.innerHTML = `
          <div class="title">${title}</div>
          <div class="details">
            ${description ? `<p>${description.textContent.trim()}</p>` : ''}
            <p>Horairesâ€¯: ${validTimes.map(t => `<span class="time">${t.textContent.trim()}</span>`).join(', ')}</p>
          </div>
        `;

        container.appendChild(filmDiv);
      });
    }

    fetchSessions();
    setInterval(fetchSessions, 5 * 60 * 1000); // RafraÃ®chit toutes les 5 minutes
  </script>
</body>
</html>
